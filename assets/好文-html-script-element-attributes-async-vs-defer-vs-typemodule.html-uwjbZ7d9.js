import{_ as e,c as t,o as s,a}from"./app-DVMZDNEl.js";const r="/images/images_unsplash_com_photo_1619545493446_b378e885c6de_crop_entropy_cs_tinysrgb_fit_max_fm_jpg_ixid_M3w0ODM4NTF8MHwxfHNlYXJjaHw0fHxsb2FkfGVufDB8fHx8MTcxNjM4ODQwNnww_ixlib_rb_4_0.png",p="/images/cdn_images_1_medium_com_max_1117_1_B4dnRdJiDywdFML4uIWZUw.png",n="/images/cdn_images_1_medium_com_max_1117_1_nmzAKz_RSbZ_E_m5B6pPaA.png",o={},c=a('<p>原文链接: <a href="https://sorrycc.com/html-script-element-attributes-async-vs-defer-vs-typemodule/" target="_blank" rel="noopener noreferrer">https://sorrycc.com/html-script-element-attributes-async-vs-defer-vs-typemodule/</a></p><h1 id="译-html-脚本元素属性-async-与-defer-与-type-module-https-sorrycc-com-html" tabindex="-1"><a class="header-anchor" href="#译-html-脚本元素属性-async-与-defer-与-type-module-https-sorrycc-com-html"><span>[译：HTML 脚本元素属性：async 与 defer 与 type=’module’](https://sorrycc.com/html-</span></a></h1><p>script-element-attributes-async-vs-defer-vs-typemodule/)</p><blockquote><p>原文：&lt;https://webdeveloper.beehiiv.com/p/html-script-element-attributes-async- vs-defer-vs-typemodule&gt;<br> 作者：Zachary Lee<br> 译者：ChatGPT 4 Turbo</p></blockquote><p><strong>编者注：一图胜千言，建议拉到最后直接看图，一目了然。</strong></p><p><img src="'+r+'" alt=""></p><p>我相信你对 HTML 中的 script 元素并不陌生。它有一些属性，例如 async、defer 等。你知道它们的作用以及它们之间的区别吗？</p><p>如果 script 元素没有添加任何属性，那么当浏览器遇到脚本时，会立即加载并执行它。在等待执行完成之后，才会继续解析后续的标签。这个阶段被称为解析 HTML。</p><p><img src="'+p+`" alt=""></p><p>如果脚本体积大或执行时间长，页面会长时间出现空白。就像上面的截图一样。这在一些 [SPA](https://en.wikipedia.org/wiki/Single- page_application?utm_source=webdeveloper.beehiiv.com&amp;utm_medium=referral&amp;utm_campaign=html- script-element-attributes-async-vs-defer-vs-type-module) 前端项目中尤其常见。</p><p>因此，针对这种情况，我们可以给 script 元素添加属性来进行优化。接下来，我将 script 元素分为三类，分别进行解释：</p><h1 id="经典脚本" tabindex="-1"><a class="header-anchor" href="#经典脚本"><span><strong>经典脚本</strong></span></a></h1><p>当我们对 script 元素省略 <code>type</code> 属性或配置为 [JavaScript MIME 类型](https://developer.mozilla.org/en- US/docs/Web/HTTP/Basics_of_HTTP/MIME_types?utm_source=webdeveloper.beehiiv.com&amp;utm_medium=referral&amp;utm_campaign=html- script-element-attributes-async-vs-defer-vs-type- module#textjavascript)（目前唯一有效的值是 <code>text/javascript</code>）时，该脚本为经典脚本。</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line">    <span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span> async<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>为经典脚本配置 async 属性时，脚本会立即获取，但不会阻塞 HTML 的解析。<strong>一旦获取完成</strong> ，它就会立即执行，如果这时 HTML 还没有解析完，就会被阻塞。</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line">    <span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;/test.js&quot;</span> defer<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>当为经典脚本配置 <code>defer</code> 属性时，脚本会立即被获取但不会阻塞 HTML 解析。它会在 HTML 解析完成后才执行，但它会阻塞 <code>DOMContentLoaded</code> 事件。</p><p>应当注意的是，如果这个经典脚本没有使用 src 属性，即一个内联脚本，<code>defer</code> 属性将没有效果。</p><h1 id="模块脚本" tabindex="-1"><a class="header-anchor" href="#模块脚本"><span><strong>模块脚本</strong></span></a></h1><p>当我们为脚本元素配置 <code>type=&quot;module&quot;</code> 时，该脚本就是一个模块脚本。</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line">    <span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;module&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>[ESM](https://developer.mozilla.org/en- US/docs/Web/JavaScript/Guide/Modules?utm_source=webdeveloper.beehiiv.com&amp;utm_medium=referral&amp;utm_campaign=html- script-element-attributes-async-vs-defer-vs-type-module) 可以在模块脚本内部使用，并且即使相同的模块脚本被加载多次，该脚本只会被执行一次。</p><p>在加载机制上，<strong>其效果与经典脚本的 defer 相同。</strong></p><p>值得注意的是，如果模块脚本配置了 <code>src</code> 属性，那么与经典脚本（允许跨域）不同，这个模块脚本需要使用 CORS 协议进行跨域获取。</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line">    <span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;module&quot;</span> async<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>当为模块脚本配置 async 属性时，其加载机制与配置了 async 的经典脚本相同。</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line">    <span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;module&quot;</span> defer<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>当为模块脚本配置 defer 属性时，此属性无效。因为模块脚本默认是“defer”的。</p><h1 id="其他" tabindex="-1"><a class="header-anchor" href="#其他"><span><strong>其他</strong></span></a></h1><p>当脚本元素的 type 属性值不是上述两个有效值时。那么这个脚本元素中的内容（包括 src）将被浏览器丢弃，不会被下载和执行。</p><h1 id="结论" tabindex="-1"><a class="header-anchor" href="#结论"><span><strong>结论</strong></span></a></h1><p>下面的截图清楚地展示了这些类型之间的差异：</p><p><img src="`+n+'" alt=""></p><p>图片来自 [WHATWG](https://html.spec.whatwg.org/multipage/scripting.html?utm_source=webdeveloper.beehiiv.com&amp;utm_medium=referral&amp;utm_campaign=html- script-element-attributes-async-vs-defer-vs-type-module)</p><p>[2024年6月6日](https://sorrycc.com/html-script-element-attributes-async-vs-defer- vs-typemodule/)</p><p>In <a href="https://sorrycc.com/category/yi/" target="_blank" rel="noopener noreferrer">好文翻译</a></p><p>© 2024 <a href="https://sorrycc.com" target="_blank" rel="noopener noreferrer">云谦的博客</a></p><p>Theme by <a href="https://andersnoren.se" target="_blank" rel="noopener noreferrer">Anders Norén</a></p>',38),i=[c];function l(m,d){return s(),t("div",null,i)}const h=e(o,[["render",l],["__file","好文-html-script-element-attributes-async-vs-defer-vs-typemodule.html.vue"]]),_=JSON.parse('{"path":"/%E5%A5%BD%E6%96%87-html-script-element-attributes-async-vs-defer-vs-typemodule.html","title":"[译：HTML 脚本元素属性：async 与 defer 与 type=’module’](https://sorrycc.com/html-","lang":"zh-CN","frontmatter":{"description":"原文链接: https://sorrycc.com/html-script-element-attributes-async-vs-defer-vs-typemodule/ [译：HTML 脚本元素属性：async 与 defer 与 type=’module’](https://sorrycc.com/html- script-element-att...","head":[["meta",{"property":"og:url","content":"https://interview.leeguoo.com/%E5%A5%BD%E6%96%87-html-script-element-attributes-async-vs-defer-vs-typemodule.html"}],["meta",{"property":"og:site_name","content":"前端面试题集锦"}],["meta",{"property":"og:title","content":"[译：HTML 脚本元素属性：async 与 defer 与 type=’module’](https://sorrycc.com/html-"}],["meta",{"property":"og:description","content":"原文链接: https://sorrycc.com/html-script-element-attributes-async-vs-defer-vs-typemodule/ [译：HTML 脚本元素属性：async 与 defer 与 type=’module’](https://sorrycc.com/html- script-element-att..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://interview.leeguoo.com/images/images_unsplash_com_photo_1619545493446_b378e885c6de_crop_entropy_cs_tinysrgb_fit_max_fm_jpg_ixid_M3w0ODM4NTF8MHwxfHNlYXJjaHw0fHxsb2FkfGVufDB8fHx8MTcxNjM4ODQwNnww_ixlib_rb_4_0.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-08-19T17:59:26.000Z"}],["meta",{"property":"article:modified_time","content":"2024-08-19T17:59:26.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"[译：HTML 脚本元素属性：async 与 defer 与 type=’module’](https://sorrycc.com/html-\\",\\"image\\":[\\"https://interview.leeguoo.com/images/images_unsplash_com_photo_1619545493446_b378e885c6de_crop_entropy_cs_tinysrgb_fit_max_fm_jpg_ixid_M3w0ODM4NTF8MHwxfHNlYXJjaHw0fHxsb2FkfGVufDB8fHx8MTcxNjM4ODQwNnww_ixlib_rb_4_0.png\\",\\"https://interview.leeguoo.com/images/cdn_images_1_medium_com_max_1117_1_B4dnRdJiDywdFML4uIWZUw.png\\",\\"https://interview.leeguoo.com/images/cdn_images_1_medium_com_max_1117_1_nmzAKz_RSbZ_E_m5B6pPaA.png\\"],\\"dateModified\\":\\"2024-08-19T17:59:26.000Z\\",\\"author\\":[]}"]]},"headers":[],"git":{"updatedTime":1724090366000,"contributors":[{"name":"guoli","email":"guoli@zhihu.com","commits":1}]},"autoDesc":true,"filePathRelative":"好文-html-script-element-attributes-async-vs-defer-vs-typemodule.md","excerpt":"<p>原文链接: <a href=\\"https://sorrycc.com/html-script-element-attributes-async-vs-defer-vs-typemodule/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://sorrycc.com/html-script-element-attributes-async-vs-defer-vs-typemodule/</a></p>\\n<h1>[译：HTML 脚本元素属性：async 与 defer 与 type=’module’](https://sorrycc.com/html-</h1>"}');export{h as comp,_ as data};
